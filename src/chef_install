#Update the apt cache
sudo apt-get update

#install dependencies
sudo apt-get install -y ruby ruby-dev libopenssl-ruby rdoc ri irb build-essential wget ssl-cert git-core

#install rubygems from source
cd /tmp
wget http://production.cf.rubygems.org/rubygems/rubygems-1.3.7.tgz
tar zxf rubygems-1.3.7.tgz
cd rubygems-1.3.7
sudo ruby setup.rb --no-format-executable

#install chef
sudo gem install --no-ri --no-rdoc chef

#install chef repository
cd ~
git clone git://github.com/opscode/chef-repo.git

#create .chef directory and setup keys
mkdir -p ~/chef-repo/.chef

#how to automate this???
cp USERNAME.pem ~/chef-repo/.chef
cp ORGANIZATION-validator.pem ~/chef-repo/.chef
cp knife.rb cd ~/chef-repo

cd ~/chef-repo
knife configure client ./client-config
sudo cp -r ~/chef-repo/client-config /etc/chef

sudo chef-client

#check that its working

knife node list


